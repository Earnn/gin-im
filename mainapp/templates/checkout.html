{% extends 'base.html' %}{% load static %} {% block content %}
    <style>
    .banner-new {
    background: url('{% static "images/fork.jpg" %}') no-repeat 0px 0px;
    background-size: cover;
    /*background-attachment: fixed;*/
    
    }

    /*  .center {
    text-align: center;
    }
    .merge-bottom-input {
    width: 67px;
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
    }
    .merge-top-left-button {
    border-top-left-radius: 0;
    }
    .merge-top-right-button {
    border-top-right-radius: 0;
    }*/
    .imgCrop-desktop{
    width: 150px;
    height:100px;
    overflow: hidden;
    position:  relative;
    }
    .inImg-desktop{
    position: absolute;
    
    width: 150px;
    height:100px;
    object-fit: cover;
    }

    .imgCrop-mobile{
    width: 100px;
    height:90px;
    overflow: hidden;
    position:  relative;
    }
    .inImg-mobile{
    position: absolute;
    
    width: 130px;
    height:90px;
    object-fit: cover;
    }
 input[type=text],.uk-textarea,.uk-select{
  background-color: #EEEEEE;  
 }
    .imgCrop{
        width: 100%;
        height: 200px;
        overflow: hidden;
        position:  relative;
        }
  /*     .uk-button-order :hover{
                color: white;
        background-color: #FFCA28;
    }*/
    </style>
    <!-- banner -->
    
    <!-- end banner -->
    <!-- <br>     -->
    <hr class="uk-box-shadow-medium "> {% csrf_token %}

      <div class="uk-background-muted" style="margin-top: -20px;">
        <div class="container profile-desktop " id="home">
            <br>
            <div class="uk-card uk-card-default">
                <div class="uk-card-body uk-margin-remove">
   <!--  <div class="container uk-margin-medium-top" id="home" style="background-color: #F8F8F8">
        <div class=" uk-margin-medium-bottom"> -->
            
               <h2 class="uk-heading-bullet">ตรวจสอบรายการ</h2>
            <hr>
            <!-- <br> -->
            <table class="uk-table uk-table-divider  uk-margin-remove-bottom  ">
                
                <tbody>
                    {% for order in output %}
                        
                        <tr>
                            <td class="uk-width-small"  >
                            <div class="image-desktop">
                                 <div class="imgCrop-desktop"><img src="../{{order.url_pic}}" class="inImg-desktop" alt="" ></div>
                            </div>
                            <div class="image-mobile">
                                 <div class="imgCrop-mobile"><img src="../{{order.url_pic}}" class="inImg-mobile" alt="" ></div>
                            </div>
                               
                                
                            </td>
                            <td class="uk-width-small"> <h4>{{order.amount}} x {{order.name}}</h4></td>
                            <td class="uk-width-small">  <h4> {{order.price}} บาท</h4></td>
                        </tr>
                    {% endfor %}
                     <tr style="font-weight: bold;color: black">
                        <td class="uk-width-small uk-text-center">   <h3 >รวม</h3></td>
                        <td class="uk-width-small"> </td>
                        <td class="uk-width-small">  <h3> {{total}} บาท</h3></td>
                        
                    </tr>
                </tbody>
            </table>
            <hr>
        <!--     <table class="uk-table " style="margin-top: -20px">
                
                <tbody class=" uk-margin-remove-top ">
                    
                    
                   
                    
                    
                </tbody>
            </table> -->
        <br>
        <h2 class="uk-heading-bullet">เบอร์โทรศัพท์ที่สามารถติดต่อได้</h2>

              <div class="uk-margin">
          <input id="myPhoneNumbet" class="uk-input" type="text" placeholder="{{delivery_phone}}">
        </div>
             <h2 class="uk-heading-bullet">ที่อยู่จัดส่ง</h2>
             <label for="">ขอบเขตที่ร้านค้าสามารถจัดส่งได้ {{store.delivery_boundary}} </label> 

              <div class="uk-margin">
            <textarea id="myTextarea" class="uk-textarea" rows="3" placeholder="{{delivery_address}}"></textarea>
        </div>
        <h2 class="uk-heading-bullet">วิธีการขำระเงิน</h2>

              <div class="uk-margin uk-width-1-3@m">
              <select id="selectPayment"  class="uk-select">
                <option>PromtPay</option>
                <option>เงินสด</option>
            </select>
        </div>
        <div id="promptpayBlock">
               <img class="imgCrop" style="width: 150px;height: 150px"  src="https://promptpay.io/0958634627.png">
        </div>
     
        <br>
        <div class="">
 <!-- <h2 class="uk-heading-bullet">เงื่อนไขและข้อตกลงในการใช้บริการ</h2> -->
            <div class="uk-card uk-card-default uk-card-body uk-width-1-2@m uk-align-center">
<h3>เงื่อนไขและข้อตกลงในการใช้บริการ</h3>
   <label>1. ขอบเขตการส่งอาหาร</label>
         <p> กรณีที่ลูกค้าระบุตำแหน่งจัดส่งสินค้านอกเหนือจากขอบเขตที่ร้านค้ากำหนด ทางร้านค้าจะไม่จัดส่งอาหาร</p>
          <label>2. เมื่อยืนยันการสั่งอาหารแล้วทางเราจะไม่รับผิดชอบใดๆทั้งสิ้น </label>
        <!-- <p> กรณีที่</p> -->
        <p> เมื่อยืนยันการสั่งอาหาร ลูกค้าติดต่อกับทางร้านค้าด้วยตนเอง</p>
        <br>
         <label class="" ><input id="conditionCheck" class="uk-checkbox " style="margin-top: -2px" type="checkbox"> ยอมรับเงื่อนไขและข้อตกลงในการใช้บริการ </label> 
</div>
           



   <!--        <label class="uk-text-center uk-text-middle" ><input id="conditionCheck" class="uk-checkbox " style="margin-top: -2px" type="checkbox"> <a href="#modal-example " uk-toggle>ยอมรับเงื่อนไขและข้อตกลงในการใช้บริการ </a></label>   --> 
        </div>




<!-- This is the modal -->
<div id="modal-example" uk-modal>
    <div class="uk-modal-dialog uk-modal-body">
        <h2 class="uk-modal-title ">เงื่อนไขและข้อตกลงในการใช้บริการ</h2>
       
        
        <p class="uk-text-right">
            <!-- <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button> -->
            <button class="uk-button uk-button-primary uk-modal-close" type="button">ตกลง</button>
        </p>
    </div>
</div>


                <button  class="uk-margin-top uk-button uk-button-order uk-align-center" id="orderBtn" style="color: white; " disabled><h1 class="uk-margin-small-top">ชำระเงิน</h1></button>
         
        </div>
              </div>
        
    </div>
    </div>
    <br>
{% block javascript %}
  <script type="text/javascript"> 
        $(document).ready(function(){
// document.getElementById("orderBtn").disabled = true;
            var ckbox = $('#conditionCheck');

    $('input').on('click',function () {
        if (ckbox.is(':checked')) {
            document.getElementById("orderBtn").disabled = false;
        } else {
            document.getElementById("orderBtn").disabled = true;
        }
    });

        var select_index = document.getElementById("selectPayment").selectedIndex;
        var y = document.getElementById("selectPayment").options;
        var payment = y[select_index].text
        var x = document.getElementById("promptpayBlock");
        if (payment ==  "PromtPay") {
              
        x.style.display = "block";
              }
        else {
           x.style.display = "none";
        }
       

            $("#orderBtn").click(function() {
              
                  
                var address =  document.getElementById("myTextarea").value;
                if (!address){
                   address=  document.getElementById("myTextarea").placeholder;
                }
                console.log(address);
                var data = JSON.stringify({{output|safe}});
                var d_address= JSON.stringify(address);
                var d_phone_number =  document.getElementById("myPhoneNumbet").value;
              
                console.log(payment);
                $.ajax({
                    url: '/delivery/',
                    type: 'GET',
                    data: {'data':data,'address':d_address,'phone_number':d_phone_number,'payment':payment,
                        csrfmiddlewaretoken: $("input[name=csrfmiddlewaretoken]").val()
                    },
                    dataType: "json",
                    contentType: 'application/json; charset=utf-8',
                    success: function(data) {
              
                      var a = "{% url 'success' order_id=112233 %}".replace("112233", data.order_id);
                      window.location.href = a;
                    
                    },
                    error: function(data) {
                        alert("การสั่งซื้อผิดพลาด กรุณาลองใหม่ภายหลัง");
                    }
                });
    });
            


        });
    </script>


{% endblock %}
  
{% endblock %}
